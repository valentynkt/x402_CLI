# Quick Start Guide: Test Your First 402 Endpoint in 90 Seconds

**Time:** 10 minutes (detailed walkthrough) | **Difficulty:** Beginner | **Prerequisites:** Rust 1.75+

This guide walks you through setting up x402-dev's mock payment server for testing. By the end, you'll have a working test environment that returns HTTP 402 status codes with mock invoices.

âš ï¸ **Important:** x402-dev is a **TESTING TOOLKIT**. It does NOT process real payments or connect to the Solana blockchain. For production use, you must integrate real payment verification separately.

---

## Prerequisites

Before starting, ensure you have:

- âœ… **Rust 1.75+** installed - Check with `rustc --version`
  - Don't have Rust? Install from [rustup.rs](https://rustup.rs) (takes 2 minutes)
- âœ… **Terminal/command line** access
- âœ… **curl** or similar HTTP client for testing
- âœ… **5 minutes** of uninterrupted time

---

## Step 1: Install x402-dev (30 seconds)

Open your terminal and run:

```bash
cargo install x402-dev
```

**Expected output:**
```
    Updating crates.io index
  Installing x402-dev v0.1.0
   Compiling x402-cli v0.1.0
   Compiling x402-core v0.1.0
    Finished release [optimized] target(s) in 18.45s
  Installing /Users/you/.cargo/bin/x402-dev
   Installed package `x402-dev v0.1.0`
```

**Verify installation:**
```bash
x402-dev --version
```

âœ… **Success!** You should see: `x402-dev 0.1.0`

---

## Step 2: Initialize Your Project (15 seconds)

Create a new directory for your test environment:

```bash
x402-dev init my-payment-test
cd my-payment-test
```

**What just happened:**
- âœ… Created `.x402dev.yaml` configuration file
- âœ… Set default port (3402) and pricing (0.01 SOL)
- âœ… Configured for mock mode (no blockchain)

**View your configuration:**
```bash
cat .x402dev.yaml
```

You'll see:
```yaml
# x402-dev configuration (generated by: x402-dev init)
mock_server:
  port: 3402
  pricing:
    default: 0.01
solana:
  rpc_url: https://api.devnet.solana.com
  network: devnet
```

âš ï¸ **Note:** Even though this shows "solana" config, x402-dev does NOT actually connect to Solana. This is for future integration.

---

## Step 3: Start Mock Server (20 seconds)

Launch the x402-dev mock server:

```bash
x402-dev mock
```

**Expected output:**
```
âœ… Config loaded: .x402dev.yaml
âœ… Mock server starting on port 3402
âœ… Mock payment processor ready
ğŸš€ Server running at http://localhost:3402

âš ï¸  MOCK MODE: No real blockchain integration
    Accepts any payment proof for testing purposes

Press Ctrl+C to stop
```

**What is mock mode?**
Mock mode simulates the x402 payment protocol **without any blockchain connection**. Perfect for:
- ğŸ§ª Local development and testing
- âœ… CI/CD pipeline testing
- ğŸ“ Learning the protocol
- âš¡ Instant feedback (no waiting for blockchain)

**Keep this terminal open** - the server is running!

---

## Step 4: Test Your Mock Endpoint (25 seconds)

Open a **new terminal** and test the endpoint:

```bash
curl -i http://localhost:3402/api/data
```

**Expected response (HTTP 402):**
```http
HTTP/1.1 402 Payment Required
WWW-Authenticate: x402-solana recipient=Test1234567890abcdefg amount=1000 currency=USDC memo=req-1731393847123 network=devnet
Content-Type: application/json

{
  "error": "Payment required",
  "amount_lamports": 1000,
  "currency": "USDC",
  "message": "Pay 0.01 SOL to access this endpoint",
  "invoice": {
    "recipient": "Test1234567890abcdefg",
    "amount": 1000,
    "memo": "req-1731393847123",
    "network": "devnet"
  }
}
```

âœ… **Perfect!** You just received a 402 Payment Required response with a mock invoice.

**What just happened:**
1. Your request hit the x402-dev mock server
2. Server generated a **mock** invoice (test address, not real)
3. Returned HTTP 402 with invoice details in `WWW-Authenticate` header
4. In a real app, client would pay and retry with proof

---

## Step 5: Test Payment Simulation (Optional - 2 minutes)

The mock server accepts ANY payment proof for testing.

**Try sending a request with a fake payment proof:**

```bash
curl -i http://localhost:3402/api/data \
  -H "X-Payment-Proof: any-random-string-works"
```

**Expected response (HTTP 200):**
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "message": "Payment verified successfully",
  "data": {
    "resource": "/api/data",
    "access_granted": true
  }
}
```

âœ… **Mock Verification:** The server accepted ANY proof without blockchain validation.

âš ï¸ **Critical Understanding:** This is ONLY for testing. Real production systems must verify actual blockchain transactions.

---

## Step 6: Verify the Protocol (Optional - 2 minutes)

Let's validate that your mock server correctly implements the 402 protocol:

### Check Server Status
```bash
x402-dev mock status
```

**Output:**
```
âœ… Mock server is running
   PID: 12345
   Port: 3402
   Uptime: 2m 34s
```

### Validate Protocol Compliance
```bash
x402-dev check http://localhost:3402/api/data
```

**Output:**
```
x402 Protocol Compliance Check
==============================

Checking: http://localhost:3402/api/data

Protocol Validation:
  âœ… HTTP 402 status code: PASS
  âœ… WWW-Authenticate header: PASS
  âœ… Header format: x402-solana
  âœ… Field 'recipient': present
  âœ… Field 'amount': present
  âœ… Field 'currency': present
  âœ… Field 'memo': present
  âœ… Field 'network': present

Overall: âœ… ALL CHECKS PASSED (8/8)

âš ï¸  Note: This validates protocol compliance only.
    Mock server does not verify real blockchain transactions.
```

---

## ğŸ‰ Congratulations!

You successfully:
- âœ… Installed x402-dev CLI
- âœ… Created a test project
- âœ… Started a mock payment server
- âœ… Received your first 402 Payment Required response
- âœ… Tested mock payment verification
- âœ… Validated x402 protocol compliance

**Total time:** ~90 seconds (as promised!) âš¡

---

## ğŸ¯ What's Next?

Now that you have a working mock server, choose your next adventure:

### ğŸ§ª Write Automated Tests (15 minutes)
Create YAML test suites to test your payment-protected endpoints in CI/CD.

**Quick example:**
```yaml
# tests/payment-flow.yaml
tests:
  - name: "Returns 402 without payment"
    request:
      url: "http://localhost:3402/api/data"
    assertions:
      - type: status_code
        expected: 402
```

```bash
x402-dev test tests/payment-flow.yaml
```

ğŸ‘‰ [Testing Guide](testing.md)

---

### ğŸ¨ Generate Policy Middleware (10 minutes)
Convert YAML policies into Express/Fastify middleware code.

**Example:** Rate limiting policy
```yaml
# policy.yaml
policies:
  - type: rate_limit
    pattern: "/api/*"
    max_requests: 100
    window: 3600
```

```bash
x402-dev policy generate policy.yaml --framework express
```

ğŸ‘‰ [Policy Engine Guide](policy.md)

---

### ğŸ“š Understand the Protocol (1 hour)
Learn how the HTTP 402 protocol works and plan your real blockchain integration.

**Topics:**
- HTTP 402 standard (RFC 7231)
- WWW-Authenticate header format
- Payment flow architecture
- Real Solana integration (what's needed)

ğŸ‘‰ [Protocol Specification](protocol.md) | [Architecture](architecture.md)

---

### ğŸ”— Integrate Real Payments (Future)
x402-dev provides the testing layer. For production, you'll need:

- `solana-client` crate for blockchain calls
- Transaction verification logic
- Payment cache (prevent replay attacks)
- Wallet/keypair management

ğŸ‘‰ [Limitations & Future Roadmap](limitations.md)

---

## ğŸš¨ Troubleshooting

### "Port 3402 already in use"

**Cause:** Another process (or previous x402-dev instance) is using the port.

**Fix:**
```bash
# Option 1: Use a different port
x402-dev mock --port 8402

# Option 2: Find and kill the process
lsof -i :3402  # Find process ID (PID)
kill -9 <PID>  # Replace <PID> with actual number

# Option 3: Stop x402-dev cleanly
x402-dev mock stop
```

---

### "Command not found: x402-dev"

**Cause:** Cargo bin directory not in PATH.

**Fix:**
```bash
# Check if cargo bin is in PATH
echo $PATH | grep .cargo/bin

# If not, add to your shell profile (~/.bashrc, ~/.zshrc, etc.)
export PATH="$HOME/.cargo/bin:$PATH"

# Reload shell
source ~/.bashrc  # or ~/.zshrc
```

---

### "Solana RPC connection failed"

**Cause:** You might think this is a real error, but remember - **x402-dev does NOT connect to Solana**.

**Reality:** This error should NOT appear because there are no real blockchain calls. If you see this, it's likely from a future feature not yet implemented.

**What to do:** Use the mock server as-is. No RPC connection needed.

---

## ğŸ“– Learn More

- [CLI Reference](cli-reference.md) - All commands with examples
- [Architecture](architecture.md) - How x402-dev works (mock mode)
- [Troubleshooting](troubleshooting.md) - Common issues & fixes
- [Limitations](limitations.md) - What's NOT implemented
- [Contributing](../CONTRIBUTING.md) - Help improve x402-dev

---

## ğŸ’¡ Pro Tips

1. **Use `--verbose` for debugging:**
   ```bash
   x402-dev mock --verbose
   ```

2. **Check system health before starting:**
   ```bash
   x402-dev doctor
   ```

3. **Test different endpoints:**
   ```bash
   # The mock server accepts any path
   curl http://localhost:3402/api/users
   curl http://localhost:3402/api/premium
   ```

4. **Understand what's real vs mock:**
   - âœ… Real: 402 protocol implementation
   - âœ… Real: HTTP server, headers, responses
   - âŒ Mock: Invoice addresses (test addresses only)
   - âŒ Mock: Payment verification (accepts anything)
   - âŒ Mock: No actual blockchain transactions

---

## âš ï¸ Critical Reminders

1. **x402-dev is a TESTING tool** - Not for production payment processing
2. **No real blockchain** - Mock server only, no Solana SDK integration
3. **Accepts any payment proof** - For testing convenience, not security
4. **Test addresses only** - Invoices contain hardcoded test addresses
5. **For production** - You must add real Solana integration separately

---

**ğŸ“ You've completed the Quick Start!** Ready to test your payment-protected APIs.

[â† Back to README](../README.md) | [CLI Reference â†’](cli-reference.md) | [Limitations â†’](limitations.md)
